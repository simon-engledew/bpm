<!DOCTYPE html>
<head>
    <script src="//unpkg.com/tone"></script>
    <style>
        html, body {
            min-height: 100%;
            width: 100%;
            padding: 0;
            margin: 0;
        }
        body {
            display: grid;
            justify-items: center;
        }
        section {
            padding: 60px 0;
        }
        ul {
            margin: 0;
            padding: 0;
            list-style-type: none;
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 10px;
        }
        ul > li {
            flex: calc(1/8);
            border: solid 2px #fff;
            outline: solid 2px #009;
            width: 50px;
            height: 50px;
            background-color: none;
            border-radius: 5px;
            background-color: #fff;
            transition: background-color 100ms ease-in-out;
        }
        ul > li:has(> input:checked) {
            background-color: #ade;
        }
        ul > li.active {
            background-color: #23A !important;
        }
        ul > li > input[type="checkbox"] {
            cursor: pointer;
            height: 100%;
            width: 100%;
            -webkit-appearance: none;
            appearance: none;
        }
        main {
            margin: 2em 0;
        }
        header, footer {
            text-align: right;
        }
    </style>
</head>
<body>
    <section>
        <header><label>bpm:</label> <input type="number" value="115" min="1" max="400" id="bpm" /> <button onclick="toggle(event)">Start</button></header>
        <main>
            <ul>
                <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li>
                <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li>
                <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li>
                <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li>

                <li><input type="checkbox" checked /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" /></li>
                <li><input type="checkbox" checked /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" /></li>
                <li><input type="checkbox" checked /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" /></li>
                <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li>

                <li><input type="checkbox" checked /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" /></li>
                <li><input type="checkbox" checked /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" /></li>
                <li><input type="checkbox" checked /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" /></li>
                <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li>

                <li><input type="checkbox" checked /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" /></li>
                <li><input type="checkbox" checked /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" /></li>
                <li><input type="checkbox" checked /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" /></li> <li><input type="checkbox" /></li>
                <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li> <li><input type="checkbox" checked /></li>
            </ul>
        </main>
    </section>
    <script>
        if ("wakeLock" in navigator) {
            navigator.wakeLock.request("screen");
        }

        const synth = new Tone.Synth({
            oscillator: { type: "sine", modulationFrequency: 0.2 },
            envelope: { attack: 0, decay: 0.5, sustain: 0, release: 0.1 },
        }).toDestination();

        let index = 0;

        new Tone.Loop((time) => {
            const pattern = [...document.querySelectorAll("ul > li > input[type='checkbox']")].map(function (e, i) {
                e.parentElement.classList[e.checked && i === index ? "add" : "remove"]("active");

                return e.checked;
            });

            if (pattern[index]) {
                synth.triggerAttackRelease(440, "8n", time);
            }

            index = (index + 1) % pattern.length;
        }, "4n").start();

        function toggle(e) {
            const transport = Tone.getTransport()
            const started = transport.state == "started";
            if (started) {
                transport.stop();
            } else {
                transport.bpm.value = parseInt(document.getElementById('bpm').value) || 100;
                transport.start();
            }
            e.target.innerText = started ? "Start" : "Stop";
        }
    </script>
</body>